/*! Copyright 2009-2017 Evernote Corporation. All rights reserved. */

var Persistent={};!function(){"use strict";Persistent.firefoxStorage={},Persistent.set=function(a,b){if(!document.location.href.match(/^(safari|chrome|ms-browser|moz-extension)/i))return console.error(document.location.href),void log.warn("Not setting persistent value for "+a+" on non-extension page.");if(void 0===b&&(b=""),FIREFOX){var c={};c[a]=b,chrome.storage.local.set(c)}try{localStorage.setItem(a,JSON.stringify(b))}catch(c){18===c.code&&FIREFOX?this.firefoxStorage[a]=b:c.code&&22===c.code&&c.name&&/quota/i.test(c.name)?log.error("Failed to serialize value for '"+a+"' with length "+JSON.stringify(b).length+", not enough space."):log.error("Failed to set localStorage because of this error: "+c.name+"("+c.code+"): "+c.stack)}},Persistent.get=function(a){var b=null;try{b=JSON.parse(window.localStorage[a])}catch(c){18===c.code&&FIREFOX&&this.firefoxStorage[a]&&(b=this.firefoxStorage[a])}return b},Persistent.getForUser=function(a,b){if(!b)throw new Error("unable to set persistent value - id is required");return Persistent.get(a+"_"+b)},Persistent.getForAllUsers=function(a){var b=[];for(var c in localStorage)try{c.indexOf(a)>-1&&c.match(/[a-z]+_\d+/i)&&b.push(Persistent.get(c))}catch(a){console.warn(a)}return b},Persistent.setForUser=function(a,b,c){if(!b)throw new Error("unable to set persistent value - id is required");Persistent.set(a+"_"+b,c)},Persistent.clearForUser=function(a,b){if(!b)throw new Error("unable to set persistent value - id is required");Persistent.clear(a+"_"+b)},Persistent.clearAll=function(){try{for(var a in window.localStorage)this.clear(a)}catch(a){18===a.code&&FIREFOX?(chrome.storage.local.clear(),this.firefoxStorage={}):log.error("Failed to clear localStorage because of this error: "+a.name+"("+a.code+"): "+a.stack)}},Persistent.clearForAllUsers=function(a){for(var b in window.localStorage)b.indexOf(a)>-1&&b.match(/[a-z]+_\d+/i)&&Persistent.clear(b)},Persistent.clear=function(a){if(!document.location.href.match(/^(safari|chrome|ms-browser|moz-extension)/i))return void(window&&window.console&&window.console.warn?window.console.warn("Not clearing persistent value for "+a+" on non-extension page."):console&&console.warn&&console.warn("Not clearing persistent value for "+a+" on non-extension page."));window&&window.localStorage&&window.localStorage.removeItem?window.localStorage.removeItem(a):localStorage&&localStorage.removeItem&&localStorage.removeItem(a),FIREFOX&&(chrome.storage.local.remove(a),delete this.firefoxStorage[a])},Persistent.hasKey=function(a){try{if(window&&window.localStorage)return window.localStorage.hasOwnProperty(a);if(localStorage)return localStorage.hasOwnProperty(a)}catch(b){if(18==b.code&&FIREFOX&&this.firefoxStorage[a])return!0}return!1}}(),Object.preventExtensions(Persistent);